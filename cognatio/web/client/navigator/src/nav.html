<!DOCTYPE html>
<!-- COGNATIO NAVIGATOR JOSH REED 2024 -->

<html>
	<head>
		<!-- Dynamically-generated import map -->
		<script>
			/**
			 * This little script switches between source files (which are numerous) and bundled code depending
			 * on whether the server is in development mode.
			 */

			// neat trick, if templating was disabled this would simply resolve to 'false'
			const dev = "{{ cognatio_config['IS_DEV'] }}" == "True" // Jinja template.
			
			// Right now these just point to the same place. However, I'm keeping the switching code here
			// so that if / when I implement versioned filename cachebusting I can re-employ this.
			const importmap_json = {
				imports: {
					"nav": "/nav/src/nav.js"
				}
			}

			if(dev)
			{
				importmap_json.imports.nav = "/nav/src/nav.js"
			}

			const importmap = document.createElement("script")
			importmap.type = "importmap"
			importmap.textContent = JSON.stringify(importmap_json)
			document.currentScript.after(importmap)
		</script>
		
		<script type="module" async>

			import { RegSWNav } from "nav";
			// Instantiate the switchyard - everything else propagates from here or events generated by the user
			let sw = new RegSWNav().fab().link(document.body)
			sw.load()
		</script>
		<link rel="stylesheet" href="/nav/assets/nav.css">
		<link rel="stylesheet" href="/nav/assets/fonts.css">

		<!-- This style block is ONLY for classes that must exist on pageload before CSS etc. loads.-->
		<style>
			.loadreg {
				position: absolute;
				top: 0px; left: 0px;
				width: 100vw; height: 100vh;
				overflow: hidden;
				z-index: 1;

				background-color: #f5f3ec;
			}
		</style>
	</head>

	<body>
		<div id="reg_loading" class="loadreg"></div>
	</body>
</html>